import{d as g,J as f,h as B,p as c,bB as P,x as z,A as D,m as U,U as M,C as n,z as d,c6 as b,bd as S,B as u,D as v,y as C,ba as y,bc as T,cc as q,_ as W,cd as H,H as $,c1 as J,aq as L,q as j,c7 as G,r as K,ce as x,W as O,c8 as Q,be as X,c2 as Y,ca as Z}from"./index.1cac1bad.js";import{_ as ee}from"./PLink.vue_vue_type_script_setup_true_lang.f43831db.js";import{d as te,b as k,c as ue}from"./Time.9bd2104a.js";import{_ as ae}from"./PSwitch.vue_vue_type_script_setup_true_lang.7eba46de.js";import{_ as ne,a as le}from"./InputNumber.3af073ba.js";import{_ as oe}from"./DrawerContent.46b0fda8.js";const se=g({__name:"PUserList",props:["data"],setup(F){const i=[{title:"ID",key:"id",render(a){return B(P,{},()=>a.id)}},{title:"\u6635\u79F0",key:"name"},{title:"\u5B9E\u4F8B\u6570\u91CF",key:"instances_count"},{title:"\u7BA1\u7406\u5458",key:"is_admin",render(a){return B(te,{checked:a.is_admin==1,readonly:!0})}},{title:"\u90AE\u7BB1",key:"email"},{title:"\u4FEE\u6539\u65F6\u95F4",key:"updated_at",render(a){return B(k,{time:new Date(a.updated_at)})}},{title:"\u521B\u5EFA\u65F6\u95F4",key:"created_at",render(a){return B(k,{time:new Date(a.created_at)})}},{title:"\u64CD\u4F5C",key:"action",render(a){return B(ee,{to:{name:"admin.user.index",params:{userId:a.id}},element:"button",size:"small","text-color":"white"},()=>"\u4FEE\u6539")}}];return(a,w)=>{const _=ue;return c(),f(_,{columns:i,data:F.data,bordered:!0},null,8,["data"])}}}),re=g({__name:"PUserEditor",props:["id"],emits:["update:id","reload"],setup(F,{emit:i}){const a=F,w=z(),_={id:0,name:"",password:"",email:"",is_admin:0,created_at:0,updated_at:0},e=D(_),l={init(){e.value=_,l.load()},load(){s.value||b.user.detail(a.id).then(r=>{e.value=r.data.attributes})},confirm(){s.value?b.user.create(e.value).then(()=>{l.close("\u7528\u6237\u521B\u5EFA\u6210\u529F\u3002",!0)}):b.user.update(a.id,e.value).then(()=>{l.close("\u7528\u6237\u4FEE\u6539\u6210\u529F\u3002",!0)})},delete(){b.user.delete(a.id).then(()=>{l.close("\u7528\u6237\u5220\u9664\u6210\u529F\u3002",!0)})},close(r,t){r&&w.success(r),t&&i("reload"),i("update:id",null)}},p=window.innerWidth,s=U(()=>a.id=="create");return M(()=>a.id,r=>!r||l.init()),(r,t)=>{const V=ne,m=le,E=W,h=k,I=H,A=$,N=oe,R=S;return c(),f(R,{"default-width":Math.min(768,d(p)),resizable:"",placement:"right","mask-closable":!1,show:!!F.id,"onUpdate:show":l.close},{default:n(()=>[u(N,{closable:"","native-scrollbar":!1},{header:n(()=>[v(C(d(s)?"\u521B\u5EFA\u7528\u6237":"\u4FEE\u6539\u7528\u6237"),1)]),footer:n(()=>[d(s)?y("",!0):(c(),f(A,{key:0,type:"error",ghost:"",onClick:t[6]||(t[6]=o=>l.delete())},{default:n(()=>[v("\u5220\u9664")]),_:1})),u(A,{type:"primary","text-color":"white",onClick:t[7]||(t[7]=o=>l.confirm())},{default:n(()=>[v(C(d(s)?"\u521B\u5EFA":"\u4FEE\u6539"),1)]),_:1})]),default:n(()=>[u(I,{model:e.value,"label-placement":"left","label-width":68,class:"mt-2",onSubmit:t[5]||(t[5]=T(o=>l.confirm(),["prevent"]))},{default:n(()=>[d(s)?y("",!0):(c(),f(m,{key:0,label:"ID"},{default:n(()=>[u(V,{value:e.value.id,"onUpdate:value":t[0]||(t[0]=o=>e.value.id=o),readonly:""},null,8,["value"])]),_:1})),u(m,{label:"\u6635\u79F0"},{default:n(()=>[u(E,{value:e.value.name,"onUpdate:value":t[1]||(t[1]=o=>e.value.name=o),placeholder:"\u8F93\u5165\u7528\u6237\u6635\u79F0"},null,8,["value"])]),_:1}),u(m,{label:"\u5BC6\u7801"},{default:n(()=>[u(E,{value:e.value.password,"onUpdate:value":t[2]||(t[2]=o=>e.value.password=o),type:"password",placeholder:d(s)?"\u8F93\u5165\u5BC6\u7801":"\u8F93\u5165\u65B0\u5BC6\u7801 \u975E\u5FC5\u586B"},null,8,["value","placeholder"])]),_:1}),u(m,{label:"\u90AE\u7BB1"},{default:n(()=>[u(E,{value:e.value.email,"onUpdate:value":t[3]||(t[3]=o=>e.value.email=o),placeholder:"\u8F93\u5165\u7528\u6237\u90AE\u7BB1"},null,8,["value"])]),_:1}),u(m,{label:"\u7C7B\u578B"},{default:n(()=>[u(ae,{modelValue:e.value.is_admin,"onUpdate:modelValue":t[4]||(t[4]=o=>e.value.is_admin=o)},{default:n(()=>[v("\u7BA1\u7406\u5458\u8D26\u53F7")]),_:1},8,["modelValue"])]),_:1}),d(s)?y("",!0):(c(),f(m,{key:1,label:"\u66F4\u65B0\u65F6\u95F4"},{default:n(()=>[u(h,{time:new Date(e.value.updated_at)},null,8,["time"])]),_:1})),d(s)?y("",!0):(c(),f(m,{key:2,label:"\u521B\u5EFA\u65F6\u95F4",class:"-mt-4"},{default:n(()=>[u(h,{time:new Date(e.value.created_at)},null,8,["time"])]),_:1})),u(q)]),_:1},8,["model"])]),_:1})]),_:1},8,["default-width","show","onUpdate:show"])}}}),de={class:"mdui-container mt-4"},ve=g({__name:"PUserIndex",setup(F){const i=D([]),a=()=>b.user.list().then(l=>{i.value=l.data.data}),w=X(),_=Y();let e;return J().listen(()=>{a(),L(()=>e=U({get:()=>w.params.userId,set:l=>_.isReady().then(()=>_.push({name:"admin.user.index",params:{userId:l}}))}))}),(l,p)=>{const s=$,r=Z;return c(),j(O,null,[u(G,null,{default:n(()=>[u(Q,{breadcrumb:["\u7BA1\u7406\u9762\u677F","\u7528\u6237\u7BA1\u7406"]},{title:n(()=>[v("\u7528\u6237\u7BA1\u7406")]),action:n(()=>[u(s,{type:"primary","text-color":"white",onClick:p[0]||(p[0]=t=>x(e)?e.value="create":e="create")},{default:n(()=>[v("\u65B0\u5EFA\u7528\u6237")]),_:1})]),_:1})]),_:1}),u(r,{class:"my-0"}),K("div",de,[u(se,{data:i.value},null,8,["data"]),u(re,{id:d(e),"onUpdate:id":p[1]||(p[1]=t=>x(e)?e.value=t:e=t),onReload:a},null,8,["id"])])],64)}}});export{ve as default};
