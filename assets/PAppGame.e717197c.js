import{d as B,J as c,h as g,p,bB as V,x as z,A as x,m as $,U as G,C as n,z as r,c6 as v,bd as M,B as u,D as E,y as A,ba as w,bc as S,cc as T,_ as q,cd as W,H as U,c1 as H,aq as J,q as L,c7 as j,r as K,ce as D,W as O,c8 as Q,be as X,c2 as Y,ca as Z}from"./index.1cac1bad.js";import{_ as ee}from"./PLink.vue_vue_type_script_setup_true_lang.f43831db.js";import{b as y,c as te}from"./Time.9bd2104a.js";import{_ as ae,a as ue}from"./InputNumber.3af073ba.js";import{_ as ne}from"./DrawerContent.46b0fda8.js";const oe=B({__name:"PAppGameList",props:["data"],setup(F){const d=[{title:"ID",key:"id",render(a){return g(V,{},()=>a.id)}},{title:"\u6E38\u620F\u540D\u79F0",key:"name"},{title:"\u955C\u50CF\u6570\u91CF",key:"apps_count"},{title:"\u5B9E\u4F8B\u6570\u91CF",key:"instances_count"},{title:"\u4FEE\u6539\u65F6\u95F4",key:"updated_at",render(a){return g(y,{time:new Date(a.updated_at)})}},{title:"\u521B\u5EFA\u65F6\u95F4",key:"created_at",render(a){return g(y,{time:new Date(a.created_at)})}},{title:"\u64CD\u4F5C",key:"action",render(a){return g(ee,{to:{name:"admin.app.game",params:{gameId:a.id}},element:"button",size:"small","text-color":"white"},()=>"\u4FEE\u6539")}}];return(a,b)=>{const _=te;return p(),c(_,{columns:d,data:F.data,bordered:!0},null,8,["data"])}}}),le=B({__name:"PAppGameEditor",props:["id"],emits:["update:id","reload"],setup(F,{emit:d}){const a=F,b=z(),_={id:0,name:"",description:"",updated_at:0,created_at:0},e=x(_),o={init(){e.value=_,o.load()},load(){l.value||v.app.game.detail(a.id).then(s=>{e.value=s.data.attributes})},confirm(){l.value?v.app.game.create(e.value).then(()=>{o.close("\u6E38\u620F\u521B\u5EFA\u6210\u529F\u3002",!0)}):v.app.game.update(a.id,e.value).then(()=>{o.close("\u6E38\u620F\u4FEE\u6539\u6210\u529F\u3002",!0)})},delete(){v.app.game.delete(a.id).then(()=>{o.close("\u6E38\u620F\u5220\u9664\u6210\u529F\u3002",!0)})},close(s,t){s&&b.success(s),t&&d("reload"),d("update:id",null)}},m=window.innerWidth,l=$(()=>a.id=="create");return G(()=>a.id,s=>!s||o.init()),(s,t)=>{const I=ae,f=ue,k=q,h=y,N=W,C=U,R=ne,P=M;return p(),c(P,{"default-width":Math.min(768,r(m)),resizable:"",placement:"right","mask-closable":!1,show:!!F.id,"onUpdate:show":o.close},{default:n(()=>[u(R,{closable:"","native-scrollbar":!1},{header:n(()=>[E(A(r(l)?"\u521B\u5EFA\u6E38\u620F":"\u4FEE\u6539\u6E38\u620F"),1)]),footer:n(()=>[r(l)?w("",!0):(p(),c(C,{key:0,type:"error",ghost:"",onClick:t[4]||(t[4]=i=>o.delete())},{default:n(()=>[E("\u5220\u9664")]),_:1})),u(C,{type:"primary","text-color":"white",onClick:t[5]||(t[5]=i=>o.confirm())},{default:n(()=>[E(A(r(l)?"\u521B\u5EFA":"\u4FEE\u6539"),1)]),_:1})]),default:n(()=>[u(N,{model:e.value,"label-placement":"left","label-width":68,class:"mt-2",onSubmit:t[3]||(t[3]=S(i=>o.confirm(),["prevent"]))},{default:n(()=>[r(l)?w("",!0):(p(),c(f,{key:0,label:"ID"},{default:n(()=>[u(I,{value:e.value.id,"onUpdate:value":t[0]||(t[0]=i=>e.value.id=i),readonly:""},null,8,["value"])]),_:1})),u(f,{label:"\u6E38\u620F\u540D\u79F0"},{default:n(()=>[u(k,{value:e.value.name,"onUpdate:value":t[1]||(t[1]=i=>e.value.name=i),placeholder:"\u8F93\u5165\u6E38\u620F\u540D\u79F0"},null,8,["value"])]),_:1}),u(f,{label:"\u6E38\u620F\u7B80\u4ECB"},{default:n(()=>[u(k,{value:e.value.description,"onUpdate:value":t[2]||(t[2]=i=>e.value.description=i),placeholder:"\u8F93\u5165\u6E38\u620F\u7B80\u4ECB",type:"textarea"},null,8,["value"])]),_:1}),r(l)?w("",!0):(p(),c(f,{key:1,label:"\u66F4\u65B0\u65F6\u95F4"},{default:n(()=>[u(h,{time:new Date(e.value.updated_at)},null,8,["time"])]),_:1})),r(l)?w("",!0):(p(),c(f,{key:2,label:"\u521B\u5EFA\u65F6\u95F4",class:"-mt-4"},{default:n(()=>[u(h,{time:new Date(e.value.created_at)},null,8,["time"])]),_:1})),u(T)]),_:1},8,["model"])]),_:1})]),_:1},8,["default-width","show","onUpdate:show"])}}}),se={class:"mdui-container mt-4"},me=B({__name:"PAppGame",setup(F){const d=x([]),a=()=>v.app.game.list().then(o=>{d.value=o.data.data}),b=X(),_=Y();let e;return H().listen(()=>{a(),J(()=>e=$({get:()=>b.params.gameId,set:o=>_.isReady().then(()=>_.push({name:"admin.app.game",params:{gameId:o}}))}))}),(o,m)=>{const l=U,s=Z;return p(),L(O,null,[u(j,null,{default:n(()=>[u(Q,{breadcrumb:["\u7BA1\u7406\u9762\u677F","\u955C\u50CF\u7BA1\u7406","\u6E38\u620F\u7BA1\u7406"]},{title:n(()=>[E("\u6E38\u620F\u5217\u8868")]),action:n(()=>[u(l,{type:"primary","text-color":"white",onClick:m[0]||(m[0]=t=>D(e)?e.value="create":e="create")},{default:n(()=>[E("\u65B0\u5EFA\u6E38\u620F")]),_:1})]),_:1})]),_:1}),u(s,{class:"my-0"}),K("div",se,[u(oe,{data:d.value},null,8,["data"]),u(le,{id:r(e),"onUpdate:id":m[1]||(m[1]=t=>D(e)?e.value=t:e=t),onReload:a},null,8,["id"])])],64)}}});export{me as default};
