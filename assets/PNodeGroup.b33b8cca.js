import{d as w,J as m,h as b,p as c,bB as V,x as z,A,m as $,U as G,C as a,z as d,c6 as v,bd as M,B as n,D as F,y as D,ba as g,bc as S,cc as T,_ as q,cd as W,H as N,c1 as H,aq as J,q as L,c7 as j,r as K,ce as x,W as O,c8 as Q,be as X,c2 as Y,ca as Z}from"./index.1cac1bad.js";import{_ as ee}from"./PLink.vue_vue_type_script_setup_true_lang.f43831db.js";import{b as C,c as te}from"./Time.9bd2104a.js";import{_ as ue,a as ne}from"./InputNumber.3af073ba.js";import{_ as ae}from"./DrawerContent.46b0fda8.js";const oe=w({__name:"PNodeGroupList",props:["data"],setup(f){const i=[{title:"ID",key:"id",render(u){return b(V,{},()=>u.id)}},{title:"\u8282\u70B9\u7EC4\u540D\u79F0",key:"name"},{title:"\u8282\u70B9\u6570\u91CF",key:"nodes_count"},{title:"\u5B9E\u4F8B\u6570\u91CF",key:"instances_count"},{title:"\u4FEE\u6539\u65F6\u95F4",key:"updated_at",render(u){return b(C,{time:new Date(u.updated_at)})}},{title:"\u521B\u5EFA\u65F6\u95F4",key:"created_at",render(u){return b(C,{time:new Date(u.created_at)})}},{title:"\u64CD\u4F5C",key:"action",render(u){return b(ee,{to:{name:"admin.node.group",params:{groupId:u.id}},element:"button",size:"small","text-color":"white"},()=>"\u4FEE\u6539")}}];return(u,E)=>{const _=te;return c(),m(_,{columns:i,data:f.data,bordered:!0},null,8,["data"])}}}),le=w({__name:"PNodeGroupEditor",props:["id"],emits:["update:id","reload"],setup(f,{emit:i}){const u=f,E=z(),_={id:0,name:"",description:"",created_at:0,updated_at:0},e=A(_),o={init(){e.value=_,o.load()},load(){l.value||v.node.group.detail(u.id).then(s=>{e.value=s.data.attributes})},confirm(){l.value?v.node.group.create(e.value).then(()=>{o.close("\u8282\u70B9\u7EC4\u521B\u5EFA\u6210\u529F\u3002",!0)}):v.node.group.update(u.id,e.value).then(()=>{o.close("\u8282\u70B9\u7EC4\u4FEE\u6539\u6210\u529F\u3002",!0)})},delete(){v.node.group.delete(u.id).then(()=>{o.close("\u8282\u70B9\u7EC4\u5220\u9664\u6210\u529F\u3002",!0)})},close(s,t){s&&E.success(s),t&&i("reload"),i("update:id",null)}},p=window.innerWidth,l=$(()=>u.id=="create");return G(()=>u.id,s=>!s||o.init()),(s,t)=>{const U=ue,B=ne,y=q,k=C,I=W,h=N,R=ae,P=M;return c(),m(P,{"default-width":Math.min(768,d(p)),resizable:"",placement:"right","mask-closable":!1,show:!!f.id,"onUpdate:show":o.close},{default:a(()=>[n(R,{closable:"","native-scrollbar":!1},{header:a(()=>[F(D(d(l)?"\u521B\u5EFA\u8282\u70B9\u7EC4":"\u4FEE\u6539\u8282\u70B9\u7EC4"),1)]),footer:a(()=>[d(l)?g("",!0):(c(),m(h,{key:0,type:"error",ghost:"",onClick:t[4]||(t[4]=r=>o.delete())},{default:a(()=>[F("\u5220\u9664")]),_:1})),n(h,{type:"primary","text-color":"white",onClick:t[5]||(t[5]=r=>o.confirm())},{default:a(()=>[F(D(d(l)?"\u521B\u5EFA":"\u4FEE\u6539"),1)]),_:1})]),default:a(()=>[n(I,{model:e.value,"label-placement":"left","label-width":84,class:"mt-2",onSubmit:t[3]||(t[3]=S(r=>o.confirm(),["prevent"]))},{default:a(()=>[d(l)?g("",!0):(c(),m(B,{key:0,label:"ID"},{default:a(()=>[n(U,{value:e.value.id,"onUpdate:value":t[0]||(t[0]=r=>e.value.id=r),readonly:""},null,8,["value"])]),_:1})),n(B,{label:"\u540D\u79F0"},{default:a(()=>[n(y,{value:e.value.name,"onUpdate:value":t[1]||(t[1]=r=>e.value.name=r),placeholder:"\u8F93\u5165\u8282\u70B9\u7EC4\u540D\u79F0"},null,8,["value"])]),_:1}),n(B,{label:"\u8282\u70B9\u7EC4\u7B80\u4ECB"},{default:a(()=>[n(y,{value:e.value.description,"onUpdate:value":t[2]||(t[2]=r=>e.value.description=r),placeholder:"\u8F93\u5165\u8282\u70B9\u7EC4\u7B80\u4ECB",type:"textarea"},null,8,["value"])]),_:1}),d(l)?g("",!0):(c(),m(B,{key:1,label:"\u66F4\u65B0\u65F6\u95F4"},{default:a(()=>[n(k,{time:new Date(e.value.updated_at)},null,8,["time"])]),_:1})),d(l)?g("",!0):(c(),m(B,{key:2,label:"\u521B\u5EFA\u65F6\u95F4",class:"-mt-4"},{default:a(()=>[n(k,{time:new Date(e.value.created_at)},null,8,["time"])]),_:1})),n(T)]),_:1},8,["model"])]),_:1})]),_:1},8,["default-width","show","onUpdate:show"])}}}),se={class:"mdui-container mt-4"},pe=w({__name:"PNodeGroup",setup(f){const i=A([]),u=()=>v.node.group.list().then(o=>{i.value=o.data.data}),E=X(),_=Y();let e;return H().listen(()=>{u(),J(()=>e=$({get:()=>E.params.groupId,set:o=>_.isReady().then(()=>_.push({name:"admin.node.group",params:{groupId:o}}))}))}),(o,p)=>{const l=N,s=Z;return c(),L(O,null,[n(j,null,{default:a(()=>[n(Q,{breadcrumb:["\u7BA1\u7406\u9762\u677F","\u8282\u70B9\u7BA1\u7406","\u8282\u70B9\u7EC4\u7BA1\u7406"]},{title:a(()=>[F("\u8282\u70B9\u7EC4\u5217\u8868")]),action:a(()=>[n(l,{type:"primary","text-color":"white",onClick:p[0]||(p[0]=t=>x(e)?e.value="create":e="create")},{default:a(()=>[F("\u65B0\u5EFA\u8282\u70B9\u7EC4")]),_:1})]),_:1})]),_:1}),n(s,{class:"my-0"}),K("div",se,[n(oe,{data:i.value},null,8,["data"]),n(le,{id:d(e),"onUpdate:id":p[1]||(p[1]=t=>x(e)?e.value=t:e=t),onReload:u},null,8,["id"])])],64)}}});export{pe as default};
